<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í•˜ë°ìŠ¤ í‚¤ìš°ê¸° v6.1</title>
    <style>
        :root { --bg: #f5f7fa; --card: #ffffff; --point: #ff4d94; --text: #333; --border: #e1e4e8; --success: #40c057; --vocal: #ff4d94; --dance: #ae3ec9; --visual: #4dadff; --variety: #fab005; --charm: #f06595; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Pretendard', sans-serif; margin: 0; padding: 0; }
        .nav-bar { display: flex; background: white; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .nav-btn { flex: 1; padding: 18px; border: none; background: transparent; color: #666; cursor: pointer; font-weight: bold; font-size: 14px; }
        .nav-btn.active { color: var(--point); border-bottom: 3px solid var(--point); background: #fffafc; }
        .container { max-width: 900px; margin: 20px auto; padding: 0 20px 100px 20px; }
        .page { display: none; }
        .page.active { display: block; }
        .card { background: var(--card); border: 1px solid var(--border); padding: 25px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); position: relative; }
        .date-display { position: absolute; top: 15px; right: 25px; text-align: right; }
        .day-count { font-weight: bold; color: var(--point); font-size: 18px; display: block; }
        .real-date { font-size: 12px; color: #888; }
        h2 { color: #222; font-size: 1.1rem; margin-top: 0; border-left: 4px solid var(--point); padding-left: 10px; margin-bottom: 15px; }
        .comm-post { border-bottom: 1px solid #eee; padding: 12px 0; }
        .comm-site { font-size: 10px; font-weight: bold; padding: 2px 5px; border-radius: 4px; margin-right: 8px; }
        .site-ebem { background: #e7f5ff; color: #1971c2; }
        .site-cafe { background: #fff0f6; color: #d6336c; }
        .member-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 15px; }
        .member-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 15px; }
        .stat-row { display: flex; align-items: center; margin-bottom: 5px; font-size: 12px; }
        .stat-label { width: 45px; color: #777; }
        .stat-bar-bg { flex: 1; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; margin: 0 8px; }
        .stat-bar-fill { height: 100%; border-radius: 3px; transition: 0.5s; }
        .primary-btn { width: 100%; padding: 15px; background: var(--point); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; margin-top: 10px; }
        .choice-btn { background: #333; font-size: 14px; margin-top: 10px; }
        .next-day-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: white; padding: 15px; border-top: 1px solid var(--border); text-align: center; z-index: 100; }
        .modal-overlay { display: none; position: fixed; z-index: 2000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.6); backdrop-filter: blur(4px); }
        .modal-content { background:white; margin:10% auto; padding:30px; width:400px; border-radius:20px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.5); }
        .report-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left; background: #fff; padding: 10px; border-radius: 8px; margin-top: 5px; }
        .report-line { font-size: 12px; border-bottom: 1px dashed #eee; padding: 2px 0; }
    </style>
</head>
<body>

<div class="nav-bar">
    <button class="nav-btn active" onclick="openPage('home', this)">ğŸ“Š í™ˆ</button>
    <button class="nav-btn" onclick="openPage('members', this)">ğŸ‘¥ ë©¤ë²„í˜„í™©</button>
</div>

<div class="container">
    <div id="home" class="page active">
        <div class="card">
            <div class="date-display">
                <span class="day-count">ìš´ì˜ <span id="current-day">1</span>ì¼ì°¨</span>
                <span class="real-date" id="current-date">2025-09-05</span>
            </div>
            <h2>ìƒíƒœ ì½˜ì†”</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div><small>ë³´ìœ  ìì‚°</small><br><strong id="p-finance">200,000,000</strong></div>
                <div><small>ì¼€ë¡œ íŒ¬ë¤</small><br><strong id="p-fandom">12,405</strong></div>
            </div>
        </div>
        
        <div class="card" id="weekly-report-card" style="display:none; background: #e7f5ff; border-color: #339af0;">
            <h2>ğŸ“ˆ ì£¼ê°„ íŠ¸ë ˆì´ë‹ ê²°ì‚° (ëˆ„ì  ìƒìŠ¹ì¹˜)</h2>
            <div id="weekly-report-content"></div>
        </div>

        <div class="card" style="background: #fff9db; border-color: #fab005;">
            <h2>ğŸ—ï¸ ì˜¤ëŠ˜ì˜ í†µí•© ë¦¬í¬íŠ¸</h2>
            <div class="news-item" id="daily-headline" style="font-size:14px; margin-bottom:10px;">â€¢ í•˜ë°ìŠ¤ ë§¤ë‹ˆì§€ë¨¼íŠ¸ ì‹œìŠ¤í…œ ê°€ë™ ì¤‘.</div>
            <div id="daily-best-comm" style="font-size:13px; color:#666; font-style:italic;">"í•˜ë°ìŠ¤ ë©¤ë²„ë“¤ ë¹„ì£¼ì–¼ ì‹¤í™”ëƒ?" - ì—ë±€ì½”ë¦¬ì•„</div>
        </div>
        
        <div class="card">
            <h2>ğŸŒ ì‹¤ì‹œê°„ ì»¤ë®¤ë‹ˆí‹° ë°˜ì‘</h2>
            <div id="comm-container" style="max-height: 300px; overflow-y: auto;"></div>
        </div>
    </div>

    <div id="members" class="page">
        <div class="member-grid" id="member-grid-container"></div>
    </div>
</div>

<div class="next-day-bar">
    <button class="primary-btn" style="background: #40c057; width: auto; padding: 12px 40px;" onclick="nextDay()">ğŸŒ™ ì˜¤ëŠ˜ ì¼ê³¼ ë§ˆë¬´ë¦¬ (Space)</button>
</div>

<div id="eventModal" class="modal-overlay">
    <div class="modal-content">
        <h2 id="event-title" style="color:var(--point); margin-top:0;">ëŒë°œ ìƒí™©!</h2>
        <p id="event-desc" style="margin: 20px 0; font-size: 14px; line-height: 1.6;"></p>
        <div id="event-choices"></div>
    </div>
</div>

<script>
    let gameState = {
        day: 1, 
        startDate: new Date('2025-09-05'),
        finance: 200000000, fandom: 12405,
        members: [
            {name: 'í‚¤ë§ˆ', vocal: 12, dance: 8, visual: 10, variety: 7, charm: 9, fatigue: 10},
            {name: 'ëµê·¤', vocal: 13, dance: 7, visual: 9, variety: 8, charm: 10, fatigue: 10},
            {name: 'ì±ˆë‚˜', vocal: 8, dance: 9, visual: 11, variety: 12, charm: 13, fatigue: 10},
            {name: 'ì†œì£¼ë¨¹', vocal: 7, dance: 11, visual: 10, variety: 14, charm: 12, fatigue: 10},
            {name: 'ì—°ì´ˆë¡', vocal: 12, dance: 9, visual: 12, variety: 6, charm: 11, fatigue: 10}
        ],
        community: [],
        weeklyLog: [] 
    };

    window.addEventListener('keydown', e => { if (e.code === 'Space' && document.getElementById('eventModal').style.display !== 'block') { nextDay(); e.preventDefault(); } });

    const ebemMsgs = ["í‚¤ë§ˆ ë…¸ë˜ ì£¼ë¨¸ë‹ˆ ëŒ€ë°• ã„·ã„·", "ì—°ì´ˆë¡ ëª¨ë¸ë§ ì§„ì§œ ì˜ë½‘í˜”ë„¤", "ì—ë±€ í˜•ë“¤ì•„ í•˜ë°ìŠ¤ ë´ë¼ ì§„ì§œ", "í•˜ë°ìŠ¤ ë–¡ìƒ ê°€ì¦ˆì•„!!", "ì˜¤ëŠ˜ ë°©ì†¡ í¼ ë¯¸ì³¤ëŠ”ë°?", "ë´‰ì¤€ ëŒ€í‘œë‹˜ ì•ˆëª© ì¸ì •í•œë‹¤", "ì•„ë‹ˆ ì±ˆë‚˜ ì˜ˆëŠ¥ê° ë­ì„? ã…‹ã…‹ã…‹", "ëµê·¤ ê³ ìŒ ë“£ê³  ì§€ë ¸ë‹¤", "ì†œì£¼ë¨¹ ì»¤ì—½ë…¸", "VRC ì•„ë°”íƒ€ í€„ ë¯¸ì¹¨"];
    const cafeMsgs = ["ì¼€ë¡œ 1ê¸° ì •ëª¨ ì–¸ì œì¸ê°€ìš”?", "ëµê·¤ë‹˜ ê³ ìŒ ë“£ê³  ê´‘ëª… ì°¾ì•˜ìŠµë‹ˆë‹¤", "ì†œì£¼ë¨¹ë‹˜ ë„ˆë¬´ ê·€ì—¬ì›Œìš” ã… ã… ", "ì±ˆë‚˜ë‹˜ ì˜¤ëŠ˜ í…ì…˜ ìµœê³ ì˜€ìŒ!", "ì´ˆë¡ë‹˜ ë¹„ì£¼ì–¼ ë³´ê³  ì…ë•í•¨", "ë§¤ë‹ˆì €ë‹˜ ë©¤ë²„ë“¤ ê³ ê¸° ì‚¬ì£¼ì„¸ìš”!"];

    const randomEvents = [
        { title: "ğŸ“¡ ë°©ì†¡ ì¥ë¹„ ë…¸í›„í™”", desc: "ì†¡ì¶œìš© ì»´í“¨í„°ê°€ ìê¾¸ ë ‰ì´ ê±¸ë¦½ë‹ˆë‹¤.", choices: [{ text: "ìµœì‹ í˜• êµì²´ (500ë§Œ)", effect: () => { gameState.finance -= 5000000; addComm('ì—ë±€', 'ì»´í“¨í„° ë°”ê¿¨ë‚˜ ë³´ë„¤? í”„ë ˆì„ ë¯¸ì³¤ë‹¤'); } }, { text: "ë²„í‹´ë‹¤", effect: () => { gameState.fandom -= 500; } }] },
        { title: "ğŸ— ì•¼ì‹ ìœ í˜¹", desc: "ë©¤ë²„ë“¤ì´ ì—°ìŠµ ëë‚˜ê³  ì•¼ì‹ì„ ì‹œì¼œë‹¬ë¼ê³  ì¡°ë¦…ë‹ˆë‹¤.", choices: [{ text: "ì‚¬ì¤€ë‹¤ (10ë§Œ)", effect: () => { gameState.finance -= 100000; gameState.members.forEach(m=>m.fatigue=Math.max(0,m.fatigue-10)); } }, { text: "ì°¸ì•„ë¼", effect: () => { gameState.members.forEach(m=>m.visual=Math.min(20,m.visual+1)); } }] },
        { title: "ğŸŒ ë©”íƒ€ë²„ìŠ¤ íŒ¬ë¯¸íŒ…", desc: "VRChat ì „ìš© ë§µì—ì„œ íŒ¬ë¯¸íŒ…ì„ ì—½ë‹ˆë‹¤.", choices: [{ text: "ê°œìµœ (200ë§Œ)", effect: () => { gameState.finance -= 2000000; gameState.fandom += 2000; } }, { text: "ì·¨ì†Œ", effect: () => {} }] },
        { title: "ğŸ˜± ì•„ë°”íƒ€ ì˜¤ë¥˜", desc: "ë°©ì†¡ ì¤‘ ì•„ë°”íƒ€ ê´€ì ˆì´ êº¾ì´ëŠ” ë²„ê·¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!", choices: [{ text: "ê¸°ìˆ íŒ€ í˜¸ì¶œ (50ë§Œ)", effect: () => { gameState.finance -= 500000; } }, { text: "ë°ˆìœ¼ë¡œ ìŠ¹í™”", effect: () => { gameState.members.forEach(m=>m.variety=Math.min(20,m.variety+1)); } }] }
    ];

    function openPage(pId, btn) {
        document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
        document.getElementById(pId).classList.add('active');
        if(btn) btn.classList.add('active');
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('current-day').innerText = gameState.day;
        
        // ë‚ ì§œ ê³„ì‚° (ì‹œì‘ì¼ + ì¼ìˆ˜-1)
        let d = new Date(gameState.startDate);
        d.setDate(d.getDate() + (gameState.day - 1));
        document.getElementById('current-date').innerText = d.toISOString().split('T')[0];
        
        document.getElementById('p-finance').innerText = gameState.finance.toLocaleString();
        document.getElementById('p-fandom').innerText = gameState.fandom.toLocaleString();
        
        document.getElementById('member-grid-container').innerHTML = gameState.members.map(m=>`
            <div class="member-card">
                <div style="margin-bottom:10px;"><strong>${m.name}</strong></div>
                ${renderStat('ë³´ì»¬',m.vocal,'var(--vocal)')}${renderStat('ëŒ„ìŠ¤',m.dance,'var(--dance)')}${renderStat('ë¹„ì£¼ì–¼',m.visual,'var(--visual)')}${renderStat('ì˜ˆëŠ¥',m.variety, 'var(--variety)')}${renderStat('ë§¤ë ¥',m.charm,'var(--charm)')}
                <div style="font-size:11px; text-align:right; margin-top:8px; color:#888;">í”¼ë¡œë„: ${m.fatigue}%</div>
            </div>
        `).join('');

        document.getElementById('comm-container').innerHTML = gameState.community.map(c=>`
            <div class="comm-post"><span class="comm-site ${c.site==='ì—ë±€'?'site-ebem':'site-cafe'}">${c.site}</span><div style="font-size:13px; margin-top:4px;">${c.content}</div></div>
        `).reverse().join('');
    }

    function renderStat(l,v,c){return `<div class="stat-row"><div class="stat-label">${l}</div><div class="stat-bar-bg"><div class="stat-bar-fill" style="width:${(v/20)*100}%; background:${c}"></div></div><div style="width:15px; text-align:right; font-size:10px;">${v}</div></div>`;}

    function nextDay() {
        let dailyReport = [];
        const stats = ['vocal', 'dance', 'visual', 'variety', 'charm'];
        const statNames = {'vocal':'ğŸ¤ë³´ì»¬', 'dance':'ğŸ’ƒëŒ„ìŠ¤', 'visual':'âœ¨ë¹„ì£¼ì–¼', 'variety':'ğŸ—£ì˜ˆëŠ¥', 'charm':'ğŸ€ë§¤ë ¥'};
        
        gameState.members.forEach(m => {
            const targetStat = stats[Math.floor(Math.random()*stats.length)];
            m[targetStat] = Math.min(20, m[targetStat] + 1);
            m.fatigue = Math.min(100, m.fatigue + 15);
            dailyReport.push({name: m.name, stat: statNames[targetStat]});
        });

        gameState.weeklyLog.push({day: gameState.day, data: dailyReport});
        if(gameState.weeklyLog.length > 7) gameState.weeklyLog.shift();

        gameState.day++;
        gameState.finance -= 500000;
        gameState.members.forEach(m => m.fatigue = Math.max(0, m.fatigue - 10));

        const eMsg = ebemMsgs[Math.floor(Math.random()*ebemMsgs.length)];
        const cMsg = cafeMsgs[Math.floor(Math.random()*cafeMsgs.length)];
        gameState.community.push({site:'ì—ë±€', content:eMsg}, {site:'ì¹´í˜', content:cMsg});
        if(gameState.community.length > 20) gameState.community.splice(0,2);
        document.getElementById('daily-best-comm').innerText = `"${eMsg}" - ì—ë±€ì½”ë¦¬ì•„`;

        if(gameState.day % 7 === 1 && gameState.day > 1) {
            showWeeklyReport();
        } else {
            document.getElementById('weekly-report-card').style.display = 'none';
        }

        updateDisplay();
        if(gameState.day % 3 === 0) triggerEvent();
        else openPage('home');
    }

    function showWeeklyReport() {
        const card = document.getElementById('weekly-report-card');
        const content = document.getElementById('weekly-report-content');
        card.style.display = 'block';

        // ë©¤ë²„ë³„ ì´ ìƒìŠ¹ ìˆ˜ì¹˜ ê³„ì‚°
        let totals = {};
        gameState.members.forEach(m => totals[m.name] = {});
        
        gameState.weeklyLog.forEach(log => {
            log.data.forEach(d => {
                totals[d.name][d.stat] = (totals[d.name][d.stat] || 0) + 1;
            });
        });

        content.innerHTML = Object.keys(totals).map(name => {
            let statSummary = Object.entries(totals[name]).map(([s, val]) => `${s} +${val}`).join(', ');
            return `<div style="margin-bottom:8px; border-bottom:1px solid #d0ebff; padding-bottom:5px;">
                <strong style="font-size:13px;">${name}</strong>: <span style="font-size:12px; color:#1971c2;">${statSummary || 'ìƒìŠ¹ ì—†ìŒ'}</span>
            </div>`;
        }).join('') + `<div style="font-size:11px; color:#888; text-align:right; margin-top:5px;">* ìµœê·¼ 7ì¼ê°„ì˜ í›ˆë ¨ ê²°ê³¼ì…ë‹ˆë‹¤.</div>`;
        
        openPage('home');
    }

    function triggerEvent() {
        const ev = randomEvents[Math.floor(Math.random()*randomEvents.length)];
        document.getElementById('event-title').innerText = ev.title;
        document.getElementById('event-desc').innerText = ev.desc;
        const cont = document.getElementById('event-choices');
        cont.innerHTML = '';
        ev.choices.forEach(c => {
            const b = document.createElement('button');
            b.className = "primary-btn choice-btn";
            b.innerText = c.text;
            b.onclick = () => { c.effect(); document.getElementById('eventModal').style.display='none'; updateDisplay(); openPage('home'); };
            cont.appendChild(b);
        });
        document.getElementById('eventModal').style.display = 'block';
    }

    function addComm(site, content) {
        gameState.community.push({ site, content });
        if(gameState.community.length > 20) gameState.community.shift();
    }

    updateDisplay();
</script>
</body>
</html>
