<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í•˜ë°ìŠ¤ í‚¤ìš°ê¸° v17.5 Final</title>
    <style>
        :root { --bg: #f5f7fa; --card: #ffffff; --point: #ff4d94; --text: #333; --border: #e1e4e8; --success: #40c057; --vocal: #ff4d94; --dance: #ae3ec9; --visual: #4dadff; --variety: #fab005; --charm: #f06595; --money: #2b8a3e; --danger: #fa5252; --sns: #405de6; --yt: #ff0000; --yz: #000000; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Pretendard', sans-serif; margin: 0; padding: 0; line-height: 1.5; overflow-x: hidden; }
        #start-page { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1a1a1a 0%, #333 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; color: white; text-align: center; }
        .start-logo { font-size: 3rem; font-weight: 900; color: var(--point); margin-bottom: 10px; text-shadow: 0 0 20px rgba(255,77,148,0.5); }
        .start-btn { padding: 18px 60px; background: var(--point); color: white; border: none; border-radius: 50px; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 10px 20px rgba(255,77,148,0.3); }
        .nav-bar { display: none; background: white; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; }
        .nav-btn { flex: 1; padding: 15px 5px; border: none; background: transparent; color: #666; cursor: pointer; font-weight: bold; font-size: 14px; }
        .nav-btn.active { color: var(--point); border-bottom: 3px solid var(--point); }
        .container { display: none; max-width: 900px; margin: 0 auto; padding: 15px 15px 100px 15px; }
        .page { display: none; }
        .page.active { display: block; }
        .card { background: var(--card); border: 1px solid var(--border); padding: 20px; border-radius: 15px; margin-bottom: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); position: relative; }
        .date-display { position: relative; text-align: right; margin-bottom: 10px; }
        .day-count { font-weight: bold; color: var(--point); font-size: 18px; }
        .stat-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .stat-item { background: #f8f9fa; padding: 10px; border-radius: 10px; }
        .stat-item strong { font-size: 15px; display: block; margin-top: 2px; }
        .member-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 15px; margin-bottom: 10px; position: relative; }
        .condition-badge { position: absolute; top: 15px; right: 15px; font-size: 18px; }
        .stat-row { display: flex; align-items: center; margin-bottom: 6px; font-size: 12px; }
        .stat-label { width: 40px; color: #777; font-size: 11px; }
        .stat-bar-bg { flex: 1; height: 8px; background: #eee; border-radius: 4px; overflow: hidden; margin: 0 8px; }
        .stat-bar-fill { height: 100%; border-radius: 4px; transition: 0.5s; }
        .primary-btn { width: 100%; padding: 14px; background: var(--point); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; margin-top: 5px; }
        .primary-btn:disabled { background: #adb5bd; cursor: not-allowed; }
        .choice-btn { width: 100%; padding: 14px; background: #f1f3f5; color: #333; border: 1px solid var(--border); border-radius: 8px; cursor: pointer; margin-bottom: 8px; text-align: left; }
        .modal-overlay { display: none; position: fixed; z-index: 9000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.7); backdrop-filter: blur(3px); }
        .modal-content { background:white; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); padding:25px; width: 85%; max-width:400px; border-radius:20px; text-align:center; box-sizing: border-box; }
        #comm-container { max-height: 200px; overflow-y: auto; text-align: left; }
        .comm-post { border-bottom: 1px solid #eee; padding: 8px 0; font-size: 12px; }
        .next-day-bar { display: none; position: fixed; bottom: 0; left: 0; width: 100%; background: white; padding: 12px; border-top: 1px solid var(--border); text-align: center; z-index: 100; }
    </style>
</head>
<body>

<div id="start-page">
    <div class="start-logo">HADES</div>
    <div class="start-sub">Management v17.5</div>
    <button class="start-btn" onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<div class="nav-bar" id="main-nav">
    <button class="nav-btn active" onclick="openPage('home', this)">ğŸ“Š í™ˆ</button>
    <button class="nav-btn" onclick="openPage('members', this)">ğŸ‘¥ ë©¤ë²„</button>
    <button class="nav-btn" onclick="openPage('manual', this)">ğŸ“… ì§€ì‹œ</button>
</div>

<div class="container" id="main-container">
    <div id="home" class="page active">
        <div class="card">
            <div class="date-display">
                <span class="day-count">ìš´ì˜ <span id="current-day">1</span>ì¼ì°¨</span>
                <span id="current-date" style="font-size:12px; color:#888;">2025-09-05</span>
            </div>
            <h2>ìƒíƒœ</h2>
            <div class="stat-grid">
                <div class="stat-item"><small>ë³´ìœ  ìì‚°</small><strong class="money-text">200,000,000ì›</strong></div>
                <div class="stat-item"><small>íŒ¬ì¹´í˜ íšŒì›</small><strong id="p-fandom">110,000ëª…</strong></div>
                <div class="stat-item"><small>ë„ˆíŠœë¸Œ êµ¬ë…</small><strong id="p-youtube">20,000ëª…</strong></div>
                <div class="stat-item"><small>SNS íŒ”ë¡œì›Œ</small><strong id="p-sns">1,000ëª…</strong></div>
            </div>
        </div>

        <div class="card" id="profit-report" style="display:none; background:#f2fcf0;">
            <h2>ğŸˆ ì¼ì¼ ë¦¬í¬íŠ¸</h2>
            <div id="profit-content" style="font-size: 13px;"></div>
        </div>

        <div class="card">
            <h2>âœï¸ ì»¤ë®¤ë‹ˆí‹° ì‘ì„±</h2>
            <select id="post-site" style="width:100%; padding:8px; margin-bottom:5px; border-radius:5px; border:1px solid #ddd;">
                <option value="íŒ¬ì¹´í˜">íŒ¬ì¹´í˜</option>
                <option value="ì—ë±€">ì—ë²°</option>
                <option value="YZ">YZ</option>
            </select>
            <input type="text" id="post-input" placeholder="ê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." style="width:100%; padding:10px; border-radius:5px; border:1px solid #ddd; box-sizing:border-box;">
            <button id="post-submit-btn" class="primary-btn" style="background:#fab005;" onclick="submitPost()">ì‘ì„± ì™„ë£Œ</button>
        </div>

        <div class="card">
            <h2>ğŸŒ ì‹¤ì‹œê°„ ë°˜ì‘</h2>
            <div id="comm-container"></div>
        </div>
    </div>

    <div id="members" class="page">
        <div id="member-grid-container"></div>
    </div>

    <div id="manual" class="page">
        <div class="card">
            <h2>ğŸ¯ ìˆ˜ë™ ì§€ì‹œ</h2>
            <select id="sel-member" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;"></select>
            <select id="sel-stat" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
                <option value="vocal">ğŸ¤ ë³´ì»¬ ì§‘ì¤‘ í›ˆë ¨</option>
                <option value="dance">ğŸ’ƒ ì•ˆë¬´ ì—°ìŠµ</option>
                <option value="visual">âœ¨ ë¹„ì£¼ì–¼ ì¼€ì–´</option>
                <option value="variety">ğŸ—£ï¸ ì˜ˆëŠ¥ ìŠ¤í”¼ì¹˜</option>
                <option value="charm">ğŸ€ ë§¤ë ¥ ê°•í™”</option>
                <option value="interview">ğŸ’¬ ê°œì¸ ë©´ë‹´ (í”¼ë¡œë„â†“/ë§¤ë ¥â†‘)</option>
                <option value="rest">ğŸ’¤ ê¿€ê°™ì€ íœ´ì‹</option>
            </select>
            <button class="primary-btn" onclick="manualAction()">ì§€ì‹œ ì™„ë£Œ</button>
        </div>

        <div class="card">
            <h2>ğŸ’¿ ì•¨ë²” ë°œë§¤</h2>
            <select id="sel-song" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
                <option value="MEGA PIECE HARMONY">MEGA PIECE HARMONY</option>
                <option value="ë‘ ë²ˆì§¸ ì§€êµ¬">ë‘ ë²ˆì§¸ ì§€êµ¬</option>
            </select>
            <button class="primary-btn" style="background:var(--vocal);" onclick="releaseAlbum()">ì•¨ë²” ë°œë§¤í•˜ê¸°</button>
        </div>
    </div>
</div>

<div class="next-day-bar" id="main-footer">
    <button class="primary-btn" style="background: #40c057;" onclick="nextDay()">ğŸŒ™ ë‹¤ìŒë‚ ë¡œ (Space)</button>
</div>

<div id="eventModal" class="modal-overlay">
    <div class="modal-content">
        <h2 id="modal-title"></h2>
        <div id="modal-body" style="margin: 15px 0; font-size: 14px; line-height:1.6;"></div>
        <div id="modal-choices"></div>
    </div>
</div>

<script>
    // [ë°ì´í„° ë³µêµ¬] ê¸°ì¡´ ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸
    const ebemMsgs = ["í•˜ë°ìŠ¤ ì–˜ë„¤ëŠ” ì§„ì§œ ëª¨ë¸ë§ í€„ë¦¬í‹°ê°€ ë³¼ ë•Œë§ˆë‹¤ ê°íƒ„ ë‚˜ì˜¤ë„¤.", "í‚¤ë§ˆ ì˜¤ëŠ˜ ê³ ìŒ ëš«ë¦¬ëŠ” ê±° ë³´ë‹ˆê¹Œ ëª© ìƒíƒœ ìµœìƒì¸ ë“¯?", "ëµê·¤ ë°©ì†¡ ê°ê°ì€ ì§„ì§œ íƒ€ê³ ë‚¬ë‹¤. ì˜¤ë””ì˜¤ ì•ˆ ë¹„ëŠ” ê±° ë´ë¼ ã…‹ã…‹ã…‹", "ì—°ì´ˆë¡ ì•„ë°”íƒ€ í…ìŠ¤ì²˜ ìˆ˜ì •í•œ ê±°ì„? ê´‘íƒì´ ì¢€ ë‹¬ë¼ì§„ ê±° ê°™ì€ë°.", "ì†”ì§íˆ ì´ ì •ë„ í€„ë¦¬í‹°ë©´ ë©”ì´ì €ë‘ ë¹„ë²¼ë„ ì•ˆ ê¿€ë¦¼.", "ì•„ë‹ˆ ì±ˆë‚˜ ì¶¤ì„  ì–µê¹Œí•˜ë˜ ë†ˆë“¤ ë‹¤ ì–´ë”” ê°”ëƒ? ë¦¬ê¹… ìì—°ìŠ¤ëŸ¬ìš´ ê±° ë´ë¼.", "ì†œì£¼ë¨¹ ì˜ˆëŠ¥ê° ë¯¸ì³¤ë„¤. ì˜¤ëŠ˜ í´ë¦½ ê° í•˜ë‚˜ ë‚˜ì™”ë‹¤.", "ê·¼ë° í•˜ë°ìŠ¤ ì• ë“¤ ì—°ìŠµëŸ‰ ì§„ì§œ ì¥ë‚œ ì•„ë‹Œ ë“¯. ì„±ì¥ ì†ë„ê°€ ë³´ì„.", "ë°©ê¸ˆ ë¦¬ì•¡ì…˜ íƒ€ì´ë° ì§€ë ¸ë‹¤. ì´ê²Œ ë²„ì¶”ì–¼ì˜ ë§›ì´ì§€.", "ì´ë²ˆ ì‹ ê³¡ ì•ˆë¬´ ë™ì„  ë³µì¡í•œë° íŠ¸ë˜í‚¹ í•˜ë‚˜ë„ ì•ˆ íŠ€ë„¤. ì¥ë¹„ ë­ ì“°ëƒ?", "í•˜ë°ìŠ¤ ìœ ì…ì¸ë° ì…ë• ê°€ì´ë“œ ì–´ë””ì„œ ë´„?", "ì˜¤ëŠ˜ ë°©ì†¡ ë³´ê³  êµ¬ë… ëˆŒë €ë‹¤. ë…¸ë˜ ì£¼ë¨¸ë‹ˆ ë“ ë“ í•˜ë„¤.", "ì–˜ë„¤ëŠ” ë©¤ë²„ë“¤ë¼ë¦¬ í‹°í‚¤íƒ€ì¹´ê°€ ì˜ ë¼ì„œ ë³´ê¸° í¸í•¨.", "ì—°ì´ˆë¡ ë¹„ì£¼ì–¼ ì‹¤í™”ëƒ? ì¸ë„¤ì¼ ë³´ê³  í™€ë¦° ë“¯ ë“¤ì–´ì˜´.", "ì†”ì§íˆ 3D ë¼ì´ë¸Œ í•  ë•Œë§ˆë‹¤ ê¸°ìˆ ë ¥ ë°œì „í•˜ëŠ” ê±° ì²´ê°ë¨.", "í‚¤ë§ˆ ëª©ì†Œë¦¬ëŠ” ì§„ì§œ ë…ë³´ì ì´ë‹¤. ì»¤ë²„ê³¡ í•˜ë‚˜ ë” ë½‘ì•„ì£¼ë¼.", "ì˜¤ëŠ˜ ëµê·¤ ë“œë¦½ ë•Œë¬¸ì— ê´‘ëŒ€ ì•„íŒŒì„œ ë°©ì†¡ ëª» ë³´ê² ìŒ ã…‹ã…‹ã…‹", "í•˜ë°ìŠ¤ ì •ë„ë©´ ë²„ì¶”ì–¼ ì”¬ì—ì„œ íƒ‘í‹°ì–´ ì¸ì •ì´ì§€.", "ì• ë“¤ í”¼ë¡œí•´ ë³´ì´ëŠ”ë° íœ´ì‹ ì¢€ ì‹œì¼œì•¼ í•  ë“¯. ì–¼êµ´ìƒ‰ì´ ì•ˆ ì¢‹ë‹¤.", "ì–˜ë„¤ëŠ” ì§„ì§œ 'ì§„ì‹¬'ì¸ ê²Œ ëŠê»´ì ¸ì„œ ì‘ì›í•˜ê²Œ ë¨."];
    const cafeMsgs = ["í•˜ë°ìŠ¤ ë©¤ë²„ë“¤ ì˜¤ëŠ˜ë„ ê³ ìƒ ë§ì•˜ì–´ìš”! í‘¹ ì‰¬ì–´ìš”~", "ì¼€ë¡œ 1ê¸° ì—¬ê¸° ì—¬ê¸° ëª¨ì—¬ë¼! ìš°ë¦¬ í•˜ë°ìŠ¤ ì§€ì¼œ!", "í‚¤ë§ˆë‹˜ ëª©ì†Œë¦¬ëŠ” ì œ ì§€ì¹œ ì¼ìƒì˜ ìœ ì¼í•œ ë¹„íƒ€ë¯¼ì´ì—ìš”.", "ì˜¤ëŠ˜ ëµê·¤ë‹˜ ë•ë¶„ì— ë°°ê¼½ ë¹ ì§€ê²Œ ì›ƒì—ˆë„¤ìš”. í•­ìƒ ê³ ë§ˆì›Œìš”!", "ìš°ë¦¬ ì±ˆë‚˜ë‹˜ ë¯¸ëª¨ê°€ ë§¤ì¼ ê²½ì‹ ë˜ëŠ”ë°... ì œ ì‹¬ì¥ ì±…ì„ì§€ì„¸ìš”!", "ì—°ì´ˆë¡ë‹˜ì˜ ë”°ëœ»í•œ ìœ„ë¡œ ë°©ì†¡ ë•ë¶„ì— ì˜¤ëŠ˜ íë§í•˜ê³  ê°‘ë‹ˆë‹¤.", "ì†œì£¼ë¨¹ë‹˜ ë§¤ë ¥ì— í•œ ë²ˆ ë¹ ì§€ë©´ ì¶œêµ¬ê°€ ì—†ë‹¤ëŠ” ê²Œ í•™ê³„ì˜ ì •ì„¤!", "í•˜ë°ìŠ¤ ê³µì‹ êµ¿ì¦ˆ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. í†µì¥ì€ ì¤€ë¹„ëìŠµë‹ˆë‹¤!", "ì˜¤ëŠ˜ ë¬´ëŒ€ ë³´ëŠ”ë° ëˆˆë¬¼ ë‚  ë»”í–ˆì–´ìš”. ìš°ë¦¬ ì• ë“¤ ë‹¤ ì»¸ë„¤...", "í•­ìƒ ë…¸ë ¥í•˜ëŠ” ëª¨ìŠµì´ ë„ˆë¬´ ì˜ˆìœ í•˜ë°ìŠ¤, ì˜¤ë˜ì˜¤ë˜ ê°€ì!", "íŒ¬ì•„íŠ¸ ê·¸ë ¤ë´¤ëŠ”ë° ì˜ˆì˜ê²Œ ë´ì£¼ì‹œë©´ ì¢‹ê² ì–´ìš”~", "ìš°ë¦¬ í•˜ë°ìŠ¤ ìŠˆìŠ¤ê¸¸ë§Œ ê±·ì! ì–¸ì œë‚˜ ì‘ì›í• ê²Œ.", "ë©¤ë²„ë“¤ ê±´ê°•ì´ ìµœìš°ì„ ì¸ ê±° ì•Œì£ ? ì•„í”„ì§€ ë§ˆìš” ã… ã… ", "ì˜¤ëŠ˜ ë°©ì†¡ë„ ë ˆì „ë“œ! í•˜ë°ìŠ¤ ë•ë¶„ì— ë‚´ì¼ ì¶œê·¼ë„ ë²„íŒë‹ˆë‹¤.", "ì„¸ìƒì—ì„œ ì œì¼ ë¹›ë‚˜ëŠ” 5ëª…ì˜ ë³„, í•˜ë°ìŠ¤ ì‚¬ë‘í•´!", "ì±ˆë‚˜ë‹˜ ëŒ„ìŠ¤ ë¸Œë ˆì´í¬ ë¶€ë¶„ ë¬´í•œ ë°˜ë³µ ì¤‘ì…ë‹ˆë‹¤. ë„ˆë¬´ ë©‹ì ¸ìš”!", "ì´ˆë³´ íŒ¬ì¸ë° í•˜ë°ìŠ¤ ë•ì§ˆ í¬ì¸íŠ¸ ì•Œë ¤ì£¼ì‹¤ ì²œì‚¬ ë¶„ ê³„ì‹ ê°€ìš”?", "ë…¸ë˜ë©´ ë…¸ë˜, ì¶¤ì´ë©´ ì¶¤, ëª»í•˜ëŠ” ê²Œ ì—†ëŠ” í•˜ë°ìŠ¤ ìµœê³ !", "í•˜ë°ìŠ¤ ë§Œë‚˜ê³  ì œ ì‚¶ì´ í–‰ë³µí•´ì¡Œì–´ìš”. ê³ ë§ˆì›Œìš” ë©¤ë²„ë“¤!", "ì˜¤ëŠ˜ ë°¤ì€ í•˜ë°ìŠ¤ ë…¸ë˜ ë“¤ìœ¼ë©´ì„œ ì¢‹ì€ ê¿ˆ ê¿€ê²Œìš”~"];
    const yzMsgs = ["ì˜¤ëŠ˜ ëµê·¤ í¼ ë¯¸ì³¤ë‹¤ ì§„ì§œ... #í•˜ë°ìŠ¤ #HADES #ëµê·¤", "í‚¤ë§ˆ ê³ ìŒ ë¶€ë¶„ì—ì„œ ì†Œë¦„ ë‹ìŒ. ì´ê²Œ ë©”ì¸ë³´ì»¬ì´ì§€. #KIMA", "í•˜ë°ìŠ¤ ì‹ ê·œ ì˜ìƒ ì‹¤í™”ì•¼? ë„ˆë¬´ ì˜ˆë»ì„œ ê¸°ì ˆí•¨ ã… ã…  #Hades_NewOutfit", "ì—°ì´ˆë¡ ë¹„ì£¼ì–¼ ê³µê²© ì‹¤í™”ëƒ... í™”ë©´ ê°€ë“ ì°¬ ë¯¸ëª¨ì— ì •ì‹  ëª» ì°¨ë¦¼.", "í•˜ë°ìŠ¤ ë©¤ë²„ë“¤ ì¼€ë¯¸ ì§„ì§œ ì¢‹ì•„í•¨. ì´ ì¡°í•© ì°¬ì„±ì´ìš”. #í•˜ë°ìŠ¤_í•©ë°©", "ì‹¤ì‹œê°„ íŠ¸ë Œë“œì— í•˜ë°ìŠ¤ ë–´ë‹¤! ê°€ë³´ìê³ ! #í•˜ë°ìŠ¤_ì‹¤íŠ¸", "ì†œì£¼ë¨¹ ì˜ˆëŠ¥ê°ì— ì˜¤ëŠ˜ í•˜ë£¨ ìŠ¤íŠ¸ë ˆìŠ¤ ë‹¤ ë‚ ë¦¼ ã…‹ã…‹ã…‹ #SOM", "ì±ˆë‚˜ ì¶¤ì„ ì€ ì§„ì§œ ë…ë³´ì ì´ì•¼. 3D ë¦¬ê¹…ì´ ì¶¤ì„ ì„ ëª» ë‹´ë„¤.", "í•˜ë°ìŠ¤ ë…¸ë˜ í•œ ë²ˆë§Œ ë“¤ì–´ë³´ì„¸ìš”. ê·€ê°€ ë…¹ìŠµë‹ˆë‹¤. #ë²„íŠœë²„ì¶”ì²œ", "ë‚˜ë§Œ í•˜ë°ìŠ¤ ì•„ëŠ” ì¤„ ì•Œì•˜ëŠ”ë° êµ¬ë…ì ëŠëŠ” ê±° ë³´ë‹ˆ ë¿Œë“¯í•´.", "í•˜ë°ìŠ¤ íŒì—…ìŠ¤í† ì–´ ì—´ë¦¬ë©´ ë°¤ìƒ˜ ëŒ€ê¸°í•  ìì‹  ìˆìŒ. #HADES_POPUP", "ì˜¤ëŠ˜ ë¦¬ì•¡ì…˜ ì§¤ ìƒì„± ì™„ë£Œ. ë„ˆë¬´ ê·€ì—½ì–ì•„... #í•˜ë°ìŠ¤_í´ë¦½", "ë²„ì¶”ì–¼ ì•„ì´ëŒì˜ ì •ì ì€ ì—­ì‹œ í•˜ë°ìŠ¤ì§€. #VirtualIdol", "ì• ë“¤ ëª©ì†Œë¦¬ í•© ì§„ì§œ ì¢‹ë‹¤. ë‹¨ì²´ê³¡ ë‚˜ì˜¤ë©´ ë¬´í•œ ìŠ¤ë° ê°.", "í•˜ë°ìŠ¤ ë•ì§ˆí•˜ë©´ì„œ ì¸ìƒì˜ ì§„ë¦¬ë¥¼ ê¹¨ë‹¬ìŒ. ê·€ì—¬ìš´ ê²Œ ìµœê³ ë‹¤.", "ì´ˆë¡ì´ ì›ƒëŠ” ê±° ë³´ë‹ˆê¹Œ ì˜¤ëŠ˜ í•  ì¼ ë‹¤ í–ˆë‹¤. #ì—°ì´ˆë¡", "í•˜ë°ìŠ¤ íŒ¬ë¤ í™”ë ¥ ë¬´ì—‡... ì‹¤ì‹œê°„ ë°˜ì‘ ì†ë„ ì‹¤í™”ì¸ê°€?", "ì˜¤ëŠ˜ ë°©ì†¡ í•˜ì´ë¼ì´íŠ¸: ì†œì£¼ë¨¹ì˜ ëœ¬ê¸ˆí¬ ë“œë¦½ ã…‹ã…‹ã…‹ #ì›ƒìŒë²¨", "í•˜ë°ìŠ¤ ì• ë“¤ ì‰¬ëŠ” ë‚ ì—” ë­ í• ê¹Œ? íœ´ì‹ ë¸Œì´ë¡œê·¸ ë³´ê³  ì‹¶ë‹¤.", "ë‚´ì¼ë„ í•˜ë°ìŠ¤ ë°©ì†¡ ìˆë‹¤! ì¸ìƒ ì‚´ ë§› ë‚˜ë„¤. #í•˜ë°ìŠ¤_ë‚´ì¼ë„"];

    let gameState = {
        day: 1, startDate: new Date('2025-09-05'), finance: 200000000, fandom: 110000, youtube: 20000, sns: 1000,
        members: [
            {name: 'í‚¤ë§ˆ', birth: '04-22', vocal: 11, dance: 10, visual: 10, variety: 9, charm: 10, fatigue: 0, cond: 'neutral', manualAct: null},
            {name: 'ëµê·¤', birth: '12-24', vocal: 11, dance: 10, visual: 10, variety: 9, charm: 10, fatigue: 0, cond: 'neutral', manualAct: null},
            {name: 'ì±ˆë‚˜', birth: '02-26', vocal: 9, dance: 10, visual: 11, variety: 9, charm: 10, fatigue: 0, cond: 'neutral', manualAct: null},
            {name: 'ì†œì£¼ë¨¹', birth: '11-11', vocal: 9, dance: 10, visual: 10, variety: 11, charm: 10, fatigue: 0, cond: 'neutral', manualAct: null},
            {name: 'ì—°ì´ˆë¡', birth: '03-26', vocal: 11, dance: 10, visual: 10, variety: 10, charm: 10, fatigue: 0, cond: 'neutral', manualAct: null},
        ],
        community: [], popupQueue: [], weeklyStats: [], pendingPost: null, hasPostedThisWeek: false
    };

    function startGame() {
        document.getElementById('start-page').style.display = 'none';
        document.getElementById('main-nav').style.display = 'flex';
        document.getElementById('main-container').style.display = 'block';
        document.getElementById('main-footer').style.display = 'block';
        updateDisplay();
    }

    function updateFandom(val) {
        gameState.fandom = Math.max(0, gameState.fandom + val);
        gameState.youtube += Math.floor(val * 0.7);
        gameState.sns += Math.floor(val * 1.2);
    }

    function updateDisplay() {
        document.getElementById('current-day').innerText = gameState.day;
        let d = new Date(gameState.startDate); d.setDate(d.getDate() + (gameState.day - 1));
        document.getElementById('current-date').innerText = d.toISOString().split('T')[0];
        document.getElementById('p-fandom').innerText = gameState.fandom.toLocaleString() + 'ëª…';
        document.getElementById('p-youtube').innerText = gameState.youtube.toLocaleString() + 'ëª…';
        document.getElementById('p-sns').innerText = gameState.sns.toLocaleString() + 'ëª…';
        
        const postBtn = document.getElementById('post-submit-btn');
        postBtn.disabled = gameState.hasPostedThisWeek;
        postBtn.innerText = gameState.hasPostedThisWeek ? "ì´ë²ˆ ì£¼ ì‘ì„± ì™„ë£Œ" : "ì‘ì„± ì™„ë£Œ";

        const condIcons = {good: 'ğŸ”¥', neutral: 'â¡ï¸', bad: 'ğŸ“‰'};
        document.getElementById('member-grid-container').innerHTML = gameState.members.map(m => `
            <div class="member-card" style="${m.fatigue >= 100 ? 'border-color:var(--danger); background:#fff5f5;' : ''}">
                <div class="condition-badge">${condIcons[m.cond]}</div>
                <strong>${m.name}</strong> <small style="color:#999;">ğŸ‚ ${m.birth}</small>
                ${renderStat('ë³´ì»¬',m.vocal,'var(--vocal)')}${renderStat('ëŒ„ìŠ¤',m.dance,'var(--dance)')}${renderStat('ë¹„ì£¼ì–¼',m.visual,'var(--visual)')}${renderStat('ë§¤ë ¥',m.charm,'var(--charm)')}
                <div style="font-size:11px; text-align:right; color:${m.fatigue >= 100 ? 'var(--danger)' : '#888'};">í”¼ë¡œë„: ${m.fatigue}%</div>
            </div>
        `).join('');
        
        document.getElementById('comm-container').innerHTML = gameState.community.slice(-30).reverse().map(c => `
            <div class="comm-post"><b>[${c.site}]</b> ${c.content}</div>
        `).join('');
    }

    function renderStat(l, v, c) { return `<div class="stat-row"><div class="stat-label">${l}</div><div class="stat-bar-bg"><div class="stat-bar-fill" style="width:${(v/20)*100}%; background:${c}"></div></div><div style="font-size:10px;">${v}</div></div>`; }

    function submitPost() {
        if (gameState.hasPostedThisWeek) return;
        const text = document.getElementById('post-input').value; if (!text) return;
        const site = document.getElementById('post-site').value;
        const bonus = Math.floor(Math.random() * 800) + 200;
        gameState.pendingPost = { site, content: `<b>${text}</b> <span style="color:var(--success);">+${bonus}</span>`, bonus };
        gameState.hasPostedThisWeek = true;
        document.getElementById('post-input').value = "";
        updateDisplay();
    }

    function manualAction() {
        const idx = document.getElementById('sel-member').value;
        const act = document.getElementById('sel-stat').value;
        gameState.members[idx].manualAct = act;
        alert(`${gameState.members[idx].name}ì—ê²Œ ì§€ì‹œë¥¼ ë‚´ë ¸ìŠµë‹ˆë‹¤.`);
    }

    function releaseAlbum() {
        const songName = document.getElementById('sel-song').value;
        const totalStat = gameState.members.reduce((a,b) => a + b.vocal + b.dance + b.charm + b.visual, 0);
        const rank = Math.max(1, 101 - Math.floor(totalStat / 2.5));
        const profit = (101 - rank) * 1500000 + 5000000;
        const fanGain = (101 - rank) * 3000;

        gameState.finance += profit;
        updateFandom(fanGain);
        gameState.popupQueue.push({
            type: 'event',
            event: { title: "ğŸ’¿ ì•¨ë²” ë°œë§¤ ê²°ê³¼", desc: `ì‹ ê³¡ <b>[${songName}]</b> ì°¨íŠ¸ <b>${rank}ìœ„</b> ì§„ì…!<br>ìˆ˜ìµ: ${profit.toLocaleString()}ì›<br>íŒ¬ë¤: +${fanGain.toLocaleString()}ëª…`, choices: [{text: "í™•ì¸", effect:()=>{}}] }
        });
        processNextPopup();
    }

    function nextDay() {
        if (document.getElementById('eventModal').style.display === 'block') return;
        
        let totalProfit = Math.floor(Math.random() * 800000) + 400000;
        gameState.finance += totalProfit;
        gameState.finance -= 500000; // ìœ ì§€ë¹„ ê³ ì •

        // í›ˆë ¨ ë° ì»¨ë””ì…˜ ë¡œì§
        gameState.members.forEach(m => {
            const r = Math.random();
            m.cond = r > 0.8 ? 'good' : (r > 0.2 ? 'neutral' : 'bad');
            
            let act = m.manualAct || ['vocal','dance','visual','variety','charm','rest'][Math.floor(Math.random()*6)];
            if(act === 'rest') m.fatigue = Math.max(0, m.fatigue - 40);
            else if(act === 'interview') {
                m.fatigue = Math.max(0, m.fatigue - 20);
                if(Math.random() < 0.4) { m.charm = Math.min(20, m.charm+1); gameState.weeklyStats.push({name: m.name, stat: 'ë§¤ë ¥', to: m.charm}); }
            } else {
                let prob = m.cond === 'good' ? 0.6 : (m.cond === 'bad' ? 0.1 : 0.3);
                if(Math.random() < prob && m[act] < 20) {
                    let prev = m[act]; m[act]++;
                    gameState.weeklyStats.push({name: m.name, stat: act, from: prev, to: m[act]});
                }
                m.fatigue = Math.min(100, m.fatigue + (m.cond === 'bad' ? 25 : 15));
            }
            m.manualAct = null;
        });

        // ì»¤ë®¤ë‹ˆí‹° ìë™ ìƒì„±
        if (Math.random() < 0.3) gameState.community.push({site:'ì—ë±€', content: ebemMsgs[Math.floor(Math.random()*ebemMsgs.length)]});
        if (Math.random() < 0.3) gameState.community.push({site:'íŒ¬ì¹´í˜', content: cafeMsgs[Math.floor(Math.random()*cafeMsgs.length)]});
        if (Math.random() < 0.3) gameState.community.push({site:'YZ', content: yzMsgs[Math.floor(Math.random()*yzMsgs.length)]});

        if(gameState.pendingPost) {
            gameState.community.push(gameState.pendingPost);
            updateFandom(gameState.pendingPost.bonus);
            gameState.pendingPost = null;
        }

        // ì£¼ê°„ ê²°ì‚° ë° ë¦¬ì…‹
        if(gameState.day % 7 === 0) {
            gameState.hasPostedThisWeek = false;
            if(gameState.weeklyStats.length > 0) {
                gameState.popupQueue.push({type: 'report', event: {title: "ğŸ—“ï¸ ì£¼ê°„ ì„±ì¥ ë³´ê³ ", desc: gameState.weeklyStats.map(s=>`${s.name}: ${s.stat} ìƒìŠ¹!`).join('<br>'), choices:[{text:"í™•ì¸"}]}});
                gameState.weeklyStats = [];
            }
        }

        // ì‹œìƒì‹ & ìƒì¼ ì²´í¬
        checkSpecialEvents();

        document.getElementById('profit-report').style.display = 'block';
        document.getElementById('profit-content').innerHTML = `ìˆ˜ìµ: <span class="money-text">${totalProfit.toLocaleString()}ì›</span> (ìœ ì§€ë¹„ -500,000ì›)`;

        gameState.day++;
        updateDisplay();
        processNextPopup();
    }

    function checkSpecialEvents() {
        // ìƒì¼ ì²´í¬
        let d = new Date(gameState.startDate); d.setDate(d.getDate() + (gameState.day - 1));
        let todayStr = `${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
        gameState.members.forEach(m => {
            if(m.birth === todayStr) {
                gameState.popupQueue.push({type:'event', event: {title:`ğŸ‚ ${m.name} ìƒì¼!`, desc:`ì˜¤ëŠ˜ì€ ${m.name}ì˜ ìƒì¼ì…ë‹ˆë‹¤. íŒŒí‹°ë¥¼ ì—´ì–´ íŒ¬ë¤ì´ í¬ê²Œ ì¦ê°€í•©ë‹ˆë‹¤!`, effect:()=>updateFandom(15000), choices:[{text:"ì¶•í•˜í•´!"}]}});
            }
        });

        // 100ì¼ ì‹œìƒì‹
        if(gameState.day % 100 === 0) {
            gameState.popupQueue.push({type:'event', event: {title:"ğŸ† í•˜ë°ìŠ¤ ì‹œìƒì‹", desc:"100ì¼ ê¸°ë… ì‹œìƒì‹ì—ì„œ ìƒì„ íœ©ì“¸ì—ˆìŠµë‹ˆë‹¤!<br>íŒ¬ë¤ +50000, ì „ì› ë§¤ë ¥ +1", effect:()=>{updateFandom(50000); gameState.members.forEach(m=>m.charm=Math.min(20, m.charm+1));}, choices:[{text:"ê°ë™ì´ë‹¤!"}]}});
        }

        // ëŒë°œ ì´ë²¤íŠ¸ (ì£¼ê°„ ë‹¨ìœ„)
        if(gameState.day % 7 === 1 && gameState.day > 1) {
            let ev = virtualEvents[Math.floor(Math.random()*virtualEvents.length)];
            gameState.popupQueue.push({type:'event', event: ev});
        }
    }

    function processNextPopup() {
        if (document.getElementById('eventModal').style.display === 'block' || gameState.popupQueue.length === 0) return;
        const item = gameState.popupQueue.shift();
        renderEventPopup(item.event);
    }

    function renderEventPopup(ev) {
        document.getElementById('modal-title').innerHTML = ev.title;
        document.getElementById('modal-body').innerHTML = ev.desc;
        document.getElementById('modal-choices').innerHTML = ev.choices.map((c, i) => 
            `<button class="primary-btn" onclick="executeChoice(${i})">${c.text}</button>`).join('');
        window.currentEvent = ev;
        document.getElementById('eventModal').style.display = 'block';
    }

    function executeChoice(idx) {
        const choice = window.currentEvent.choices[idx];
        if(choice.effect) choice.effect();
        else if(window.currentEvent.effect) window.currentEvent.effect();
        closeModal();
    }

    function closeModal() { document.getElementById('eventModal').style.display = 'none'; setTimeout(processNextPopup, 200); }

    function openPage(pId, btn) {
        document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
        document.getElementById(pId).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        if(pId === 'manual') {
            document.getElementById('sel-member').innerHTML = gameState.members.map((m,i)=>`<option value="${i}">${m.name} (í”¼ë¡œ:${m.fatigue}%)</option>`).join('');
        }
    }

    window.addEventListener('keydown', e => { if(e.code === 'Space' && document.activeElement.id !== 'post-input') nextDay(); });
</script>
</body>
</html>
