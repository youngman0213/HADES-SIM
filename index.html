<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í•˜ë°ìŠ¤ í‚¤ìš°ê¸° v9.4</title>
    <style>
        :root { --bg: #f5f7fa; --card: #ffffff; --point: #ff4d94; --text: #333; --border: #e1e4e8; --success: #40c057; --vocal: #ff4d94; --dance: #ae3ec9; --visual: #4dadff; --variety: #fab005; --charm: #f06595; --money: #2b8a3e; --danger: #fa5252; --sns: #405de6; --yt: #ff0000; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Pretendard', sans-serif; margin: 0; padding: 0; }
        .nav-bar { display: flex; background: white; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .nav-btn { flex: 1; padding: 18px; border: none; background: transparent; color: #666; cursor: pointer; font-weight: bold; font-size: 14px; }
        .nav-btn.active { color: var(--point); border-bottom: 3px solid var(--point); background: #fffafc; }
        .container { max-width: 900px; margin: 20px auto; padding: 0 20px 100px 20px; }
        .page { display: none; }
        .page.active { display: block; }
        .card { background: var(--card); border: 1px solid var(--border); padding: 25px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); position: relative; }
        .date-display { position: absolute; top: 15px; right: 25px; text-align: right; }
        .day-count { font-weight: bold; color: var(--point); font-size: 18px; display: block; }
        .real-date { font-size: 12px; color: #888; }
        h2 { color: #222; font-size: 1.1rem; margin-top: 0; border-left: 4px solid var(--point); padding-left: 10px; margin-bottom: 15px; }
        .money-text { color: var(--money); font-weight: bold; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-item small { color: #777; font-size: 12px; }
        .stat-item strong { font-size: 16px; display: block; margin-top: 2px; }
        .comm-post { border-bottom: 1px solid #eee; padding: 12px 0; }
        .comm-site { font-size: 10px; font-weight: bold; padding: 2px 5px; border-radius: 4px; margin-right: 8px; }
        .site-ebem { background: #e7f5ff; color: #1971c2; }
        .site-cafe { background: #fff0f6; color: #d6336c; }
        .site-sns { background: #f0f1ff; color: var(--sns); }
        .member-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 15px; }
        .stat-row { display: flex; align-items: center; margin-bottom: 5px; font-size: 12px; }
        .stat-label { width: 45px; color: #777; }
        .stat-bar-bg { flex: 1; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; margin: 0 8px; }
        .stat-bar-fill { height: 100%; border-radius: 3px; transition: 0.5s; }
        .primary-btn { width: 100%; padding: 15px; background: var(--point); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; margin-top: 10px; }
        .next-day-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: white; padding: 15px; border-top: 1px solid var(--border); text-align: center; z-index: 100; }
        .modal-overlay { display: none; position: fixed; z-index: 2000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.6); backdrop-filter: blur(4px); }
        .modal-content { background:white; margin:10% auto; padding:30px; width:450px; border-radius:20px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

<div class="nav-bar">
    <button class="nav-btn active" onclick="openPage('home', this)">ğŸ“Š í™ˆ</button>
    <button class="nav-btn" onclick="openPage('members', this)">ğŸ‘¥ ë©¤ë²„í˜„í™©</button>
    <button class="nav-btn" onclick="openPage('manual', this)">ğŸ“… ìˆ˜ë™ì§€ì‹œ</button>
</div>

<div class="container">
    <div id="home" class="page active">
        <div class="card">
            <div class="date-display">
                <span class="day-count">ìš´ì˜ <span id="current-day">1</span>ì¼ì°¨</span>
                <span class="real-date" id="current-date">2025-09-05</span>
            </div>
            <h2>ìƒíƒœ</h2>
            <div class="stat-grid">
                <div class="stat-item"><small>ë³´ìœ  ìì‚°</small><strong id="p-finance" class="money-text">200,000,000</strong></div>
                <div class="stat-item"><small>ì¼€ë¡œ íŒ¬ë¤ìˆ˜</small><strong id="p-fandom">12,405</strong></div>
                <div class="stat-item"><small>ë„ˆíŠœë¸Œ êµ¬ë…ì</small><strong id="p-youtube">8,200</strong></div>
                <div class="stat-item"><small>SNS íŒ”ë¡œì›Œ</small><strong id="p-sns">15,300</strong></div>
            </div>
        </div>
        <div class="card" id="profit-report" style="display:none; background: #f2fcf0; border-color: #40c057;">
            <h2>ğŸˆ ì¼ì¼ ìˆ˜ìµ ë¦¬í¬íŠ¸ </h2>
            <div id="profit-content" style="font-size: 14px;"></div>
        </div>
        <div class="card">
            <h2>ğŸŒ ì»¤ë®¤ë‹ˆí‹° / SNS ë°˜ì‘ </h2>
            <div id="comm-container"></div>
        </div>
    </div>
    <div id="members" class="page">
        <div class="member-grid" id="member-grid-container"></div>
    </div>
    <div id="manual" class="page">
        <div class="card">
            <h2>ìˆ˜ë™ ì§€ì‹œ </h2>
            <select id="sel-member" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px;"></select>
            <select id="sel-stat" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px;">
                <option value="vocal">ğŸ¤ ë³´ì»¬ ì§‘ì¤‘ í›ˆë ¨</option>
                <option value="dance">ğŸ’ƒ ì•ˆë¬´ ì—°ìŠµ</option>
                <option value="visual">âœ¨ ë¹„ì£¼ì–¼ ì¼€ì–´</option>
                <option value="variety">ğŸ—£ï¸ ì˜ˆëŠ¥ ìŠ¤í”¼ì¹˜</option>
                <option value="charm">ğŸ€ ë§¤ë ¥ ê°•í™”</option>
                <option value="stream">ğŸ“¡ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°</option>
                <option value="rest">ğŸ’¤ ê¿€ê°™ì€ íœ´ì‹ (í”¼ë¡œë„ ì¶”ê°€ íšŒë³µ)</option>
            </select>
            <button class="primary-btn" onclick="manualTrainAction()">ì§€ì‹œ ì™„ë£Œ</button>
        </div>
    </div>
</div>

<div class="next-day-bar">
    <button class="primary-btn" style="background: #40c057; width: auto; padding: 12px 40px;" onclick="nextDay()">ğŸŒ™ ë‹¤ìŒë‚ ë¡œ (Space)</button>
</div>

<div id="eventModal" class="modal-overlay">
    <div class="modal-content">
        <h2 id="modal-title">ì•Œë¦¼</h2>
        <div id="modal-body" style="margin: 20px 0;"></div>
        <div id="modal-choices"></div>
    </div>
</div>

<script>
    let gameState = {
        day: 1, startDate: new Date('2025-09-05'), finance: 200000000, fandom: 12405, youtube: 8200, sns: 15300,
        members: [
            {name: 'í‚¤ë§ˆ', birth: '04-22', age: '??', vocal: 11, dance: 10, visual: 10, variety: 9, charm: 10, fatigue: 10, manualAct: null},
            {name: 'ëµê·¤', birth: '12-24', age: '??', vocal: 11, dance: 10, visual: 10, variety: 9, charm: 10, fatigue: 10, manualAct: null},
            {name: 'ì±ˆë‚˜', birth: '02-26', age: '24', vocal: 9, dance: 10, visual: 11, variety: 9, charm: 10, fatigue: 10, manualAct: null},
            {name: 'ì†œì£¼ë¨¹', birth: '11-11', age: '??', vocal: 9, dance: 10, visual: 10, variety: 11, charm: 10, fatigue: 10, manualAct: null},
            {name: 'ì—°ì´ˆë¡', birth: '03-26', age: '??', vocal: 11, dance: 10, visual: 10, variety: 10, charm: 10, fatigue: 10, manualAct: null},
        ],
        community: [], weeklyLog: [], popupQueue: []
    };

    // ë°ì´í„°ë² ì´ìŠ¤ í™•ì¥
    const snsComments = [
        "ë¶„ìœ„ê¸° ì—¬ì‹ ì´ë‹¤ ì§„ì§œ..", "ì´ ì˜· ì°°ë–¡ì´ë„¤", "ì‚¬ë‘í•´ìš” í•˜ë°ìŠ¤!", "ë¯¸ëª¨ê°€ ë³µì§€ë‹¤", "ëŒ“ê¸€ ì¢€ ë‹¬ì•„ì¤˜ìš”!", 
        "1ì£¼ì¼ì„ ê¸°ë‹¤ë¦° ë³´ëŒì´ ìˆë„¤", "ì‚¬ì§„ ë³´ì • ëˆ„ê°€í•¨? ì²œì¬ì„", "í•˜ë°ìŠ¤ ë•ë¶„ì— ì‚´ë§›ë‚¨", "íŒ¬ì¹´í˜ ê°€ì…í•˜ê¸¸ ì˜í–ˆë‹¤", "ì‹¤ë¬¼ ë³´ë©´ ê¸°ì ˆí• ë“¯",
        "í‚¤ë§ˆ ì˜¤ëŠ˜ ì§„ì§œ ì˜ˆì˜ë‹¤", "ì±ˆë‚˜ ì›ƒëŠ”ê±° ë³´ì†Œ ã…‹ã…‹", "ì—°ì´ˆë¡ ëˆˆë¹›ì— ì¹˜ì¸ë‹¤", "ëµê·¤ ëª©ì†Œë¦¬ê°€ ë“¤ë¦¬ëŠ” ì‚¬ì§„", "ì†œì£¼ë¨¹ ì¹´ë¦¬ìŠ¤ë§ˆ ë¬´ì—‡",
        "ì˜¤ëŠ˜ë„ ë ˆì „ë“œ ê°±ì‹ ", "í•˜ë°ìŠ¤ê°€ ë‚˜ë¼ë‹¤", "ëŒ€í‘œë‹˜ ëˆ ë§ì´ ë²„ì„¸ìš”", "ë‹¤ìŒ í™œë™ ì–¸ì œì„?", "ì˜ì›íˆ í•¨ê»˜í•˜ì"
    ];

    const ytComments = [
        "ì´ë²ˆ ì˜ìƒ í€„ë¦¬í‹° ë¯¸ì³¤ë‹¤", "ì¡°íšŒìˆ˜ ë–¡ìƒ ê°€ì¦ˆì•„!", "ì•Œê³ ë¦¬ì¦˜ì´ ë‚˜ë¥¼ ì—¬ê¸°ë¡œ ì´ëŒì—ˆë‹¤", "ë©¤ë²„ë“¤ ì¼€ë¯¸ ëŒ€ë°•ì„ ã…‹ã…‹", "ì´ê²Œ ë²„íŠœë²„ì˜ ë¯¸ë˜ë‹¤",
        "ë¬´í•œë°˜ë³µì¤‘ì…ë‹ˆë‹¤", "í•´ì™¸ íŒ¬ë“¤ë„ ë‚œë¦¬ë‚¬ë„¤", "ìŒìƒ‰ì´ ë„ˆë¬´ ë…ë³´ì ì„", "í¸ì§‘ì ëˆ„êµ¬ì„? ë³´ë„ˆìŠ¤ ì¤˜ì•¼í•¨", "í•˜ë°ìŠ¤ëŠ” ì°ì´ë‹¤",
        "ë…¸ë˜ ì‹¤ë ¥ ì†Œë¦„ ë‹ìŒ", "ì¶¤ì„ ì´ ë„ˆë¬´ ì˜ˆë»ìš”", "ì˜ˆëŠ¥ê°ê¹Œì§€ ê°–ì¶”ë©´ ì–´ì©Œë¼ëŠ”ê±°", "ì…ë• ë¶€ì •ê¸° ëë‚¬ë‹¤", "ì˜¤ëŠ˜ ì  ë‹¤ ì¤ë‹¤",
        "ì¡°íšŒìˆ˜ 1ì–µ ê°€ì!", "ëŒ“ê¸€ ì½ê¸° ì˜ìƒë„ í•´ì£¼ì„¸ìš”", "ë§¤ì¼ ë´ë„ ì•ˆ ì§ˆë¦¼", "í•˜ë°ìŠ¤ ë©¤ë²„ë“¤ ë‹¤ ë§¤ë ¥ìˆìŒ", "ì´ ì˜ìƒ ì•ˆ ë³¸ ì‚¬ëŒ ì—†ê²Œ í•´ì£¼ì„¸ìš”",
        "ìŠ¤ì¼€ì¤„ ë¹¡ë¹¡í•œê°€? ë©¤ë²„ë“¤ ì‰¬ê²Œ í•´ì£¼ì„¸ìš”", "ë…¸ë˜ ë“£ê³  ìš¸ì—ˆìŠµë‹ˆë‹¤", "ì´ëŸ° ê¸°íš ë„ˆë¬´ ì¢‹ì•„ìš”", "ìë§‰ ì„¼ìŠ¤ êµ¿", "í•˜ë°ìŠ¤ í™”ì´íŒ…!",
        "ì˜¤ëŠ˜ í•˜ë£¨ì˜ í”¼ë¡œê°€ í’€ë¦¬ë„¤", "ëª©ì†Œë¦¬ ë³´ë¬¼ì´ë‹¤ ì§„ì§œ", "ë¹„ì£¼ì–¼ ê³µê²© ë¬´ì—‡", "íŒ¬ë¯¸íŒ… ì œë°œ í•´ì£¼ì„¸ìš”", "í•˜ë°ìŠ¤ê°€ ë²„íŠœë²„ ì›íƒ‘ì„"
    ];

    window.addEventListener('keydown', e => { 
        if (e.code === 'Space') {
            const modal = document.getElementById('eventModal');
            if (modal.style.display === 'block') {
                const type = modal.getAttribute('data-type');
                if (type === 'weekly' || type === 'birthday') closeModal();
            } else { nextDay(); }
        }
    });

    function updateFandom(val) {
        gameState.fandom += val;
        gameState.youtube += Math.floor(val * 0.7);
        gameState.sns += Math.floor(val * 1.2);
    }

    function updateDisplay() {
        document.getElementById('current-day').innerText = gameState.day;
        let d = new Date(gameState.startDate); d.setDate(d.getDate() + (gameState.day - 1));
        document.getElementById('current-date').innerText = d.toISOString().split('T')[0];
        document.getElementById('p-finance').innerText = gameState.finance.toLocaleString();
        document.getElementById('p-fandom').innerText = gameState.fandom.toLocaleString();
        document.getElementById('p-youtube').innerText = gameState.youtube.toLocaleString();
        document.getElementById('p-sns').innerText = gameState.sns.toLocaleString();
        
        document.getElementById('member-grid-container').innerHTML = gameState.members.map(m => `
            <div class="member-card" style="${m.fatigue >= 100 ? 'border-color:var(--danger); background:#fff5f5;' : ''}">
                <div style="display:flex; justify-content:space-between;">
                    <strong>${m.name}</strong><span style="font-size:10px; color:#999;">ğŸ‚ ${m.birth} (${m.age}ì„¸)</span>
                </div>
                ${renderStat('ë³´ì»¬',m.vocal,'var(--vocal)')}${renderStat('ëŒ„ìŠ¤',m.dance,'var(--dance)')}${renderStat('ë¹„ì£¼ì–¼',m.visual,'var(--visual)')}${renderStat('ì˜ˆëŠ¥',m.variety, 'var(--variety)')}${renderStat('ë§¤ë ¥',m.charm,'var(--charm)')}
                <div style="font-size:11px; text-align:right; color:${m.fatigue >= 100 ? 'var(--danger)' : '#888'};">í”¼ë¡œë„: ${m.fatigue}%</div>
            </div>
        `).join('');
        document.getElementById('comm-container').innerHTML = gameState.community.map(c => `
            <div class="comm-post"><span class="comm-site ${c.site==='SNS'?'site-sns':(c.site==='ì—ë±€'?'site-ebem':'site-cafe')}">${c.site}</span><div style="font-size:13px; margin-top:4px;">${c.content}</div></div>
        `).reverse().join('');

        const sel = document.getElementById('sel-member');
        if(sel.options.length === 0) gameState.members.forEach(m => sel.innerHTML += `<option value="${m.name}">${m.name}</option>`);
    }

    function renderStat(l, v, c) {
        return `<div class="stat-row"><div class="stat-label">${l}</div><div class="stat-bar-bg"><div class="stat-bar-fill" style="width:${(v/20)*100}%; background:${v>=20?'#333':c}"></div></div><div style="font-size:10px;">${v}</div></div>`;
    }

    function nextDay() {
        let totalProfit = Math.floor(Math.random() * 600001) + 400000;
        let dailyReport = [];
        const actionsPool = ['vocal', 'dance', 'visual', 'variety', 'charm', 'rest'];

        gameState.members.forEach(m => {
            let action = m.manualAct || actionsPool[Math.floor(Math.random() * actionsPool.length)];
            if (action === 'rest') {
                m.fatigue = Math.max(0, m.fatigue - (Math.random() < 0.8 ? 15 : 20)); // ìì—°íšŒë³µ 10 í¬í•¨
                m.manualAct = null; return;
            }
            if (m.fatigue >= 100) { m.manualAct = null; return; }
            if (m[action] < 20) {
                if (Math.random() < 0.3) {
                    m[action] = Math.min(20, m[action] + 1); m.fatigue = Math.min(100, m.fatigue + 15);
                    dailyReport.push({name: m.name, stat: action, msg: "ì„±ê³µ"});
                } else { m.fatigue = Math.min(100, m.fatigue + (Math.floor(Math.random() * 6) + 5)); }
            }
            m.manualAct = null;
        });

        // SNS ì—…ë¡œë“œ (1ì£¼ì¼ì— í•œ ë²ˆ, ì¼ìš”ì¼ë§ˆë‹¤)
        if (gameState.day % 7 === 0) {
            const randomMember = gameState.members[Math.floor(Math.random()*gameState.members.length)];
            const randomComment = snsComments[Math.floor(Math.random()*snsComments.length)];
            gameState.community.push({site:'SNS', content: `ğŸ“± @${randomMember.name}: ì´ë²ˆ ì£¼ë„ ìˆ˜ê³ í–ˆì–´ìš”! (ëŒ“ê¸€: ${randomComment})`});
        }

        let d = new Date(gameState.startDate); d.setDate(d.getDate() + (gameState.day - 1));
        let dateStr = `${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
        gameState.members.forEach(m => { if (m.birth === dateStr) gameState.popupQueue.push({type: 'birthday', member: m}); });

        gameState.finance += totalProfit; gameState.finance -= 500000;
        updateFandom(Math.floor(totalProfit / 10000));
        gameState.day++;
        gameState.members.forEach(m => m.fatigue = Math.max(0, m.fatigue - 10));
        gameState.weeklyLog.push({day: gameState.day-1, data: dailyReport});
        
        document.getElementById('profit-report').style.display = 'block';
        document.getElementById('profit-content').innerHTML = `ì–´ì œ ìˆ˜ìµ: <span class="money-text">${totalProfit.toLocaleString()}ì›</span>`;
        updateDisplay();
        if(gameState.day % 7 === 1 && gameState.day > 1) gameState.popupQueue.push('weekly');
        processNextPopup();
    }

    function processNextPopup() {
        if(gameState.popupQueue.length === 0) { openPage('home'); return; }
        const item = gameState.popupQueue.shift();
        if(item === 'weekly') showWeeklyReportPopup();
        else if(item.type === 'birthday') showBirthdayPopup(item.member);
    }

    function showWeeklyReportPopup() {
        const modal = document.getElementById('eventModal');
        modal.setAttribute('data-type', 'weekly');
        const views = (Math.floor(Math.random() * 291) + 10) * 10000;
        const starMember = gameState.members[Math.floor(Math.random()*gameState.members.length)].name;
        const selectedComments = [];
        for(let i=0; i<3; i++) selectedComments.push(ytComments[Math.floor(Math.random()*ytComments.length)]);

        document.getElementById('modal-title').innerText = "ğŸ“ˆ ì£¼ê°„ í™œë™ ê²°ì‚°";
        document.getElementById('modal-body').innerHTML = `
            <div style="background:#fff5f5; border-radius:10px; padding:15px; text-align:left;">
                <strong style="color:var(--yt)">ğŸ“º ë„ˆíŠœë¸Œ ì„±ê³¼ ë³´ê³ </strong><br>
                <div style="margin:8px 0; font-size:15px; font-weight:bold;">ì´ë²ˆ ì£¼ ì£¼ì¸ê³µ: <span style="color:var(--point)">${starMember}</span></div>
                <div style="font-size:16px; font-weight:bold;">ëˆ„ì  ì¡°íšŒìˆ˜: ${views.toLocaleString()}íšŒ</div>
                <hr style="border:0.5px solid #eee; margin:10px 0;">
                <div style="font-size:12px; color:#555;"><strong>íŒ¬ë“¤ì˜ ì‹¤ì‹œê°„ ë°˜ì‘:</strong><br>
                - ${selectedComments[0]}<br>- ${selectedComments[1]}<br>- ${selectedComments[2]}</div>
            </div>`;
        document.getElementById('modal-choices').innerHTML = `<button class="primary-btn" style="background:#339af0;" onclick="closeModal()">í™•ì¸ (Space)</button>`;
        modal.style.display = 'block';
    }

    function showBirthdayPopup(m) {
        const modal = document.getElementById('eventModal');
        modal.setAttribute('data-type', 'birthday');
        updateFandom(15000);
        m.vocal = Math.min(20, m.vocal + 1); m.dance = Math.min(20, m.dance + 1); m.visual = Math.min(20, m.visual + 1);
        m.variety = Math.min(20, m.variety + 1); m.charm = Math.min(20, m.charm + 1);
        document.getElementById('modal-title').innerText = `ğŸ‚ HAPPY BIRTHDAY!`;
        document.getElementById('modal-body').innerHTML = `<h3 style="color:var(--point);">${m.name}ì˜ ìƒì¼ì…ë‹ˆë‹¤!</h3><p>íŒ¬ë¤ +15,000 / ì „ìŠ¤íƒ¯ +1</p>`;
        document.getElementById('modal-choices').innerHTML = `<button class="primary-btn" onclick="closeModal()">ì¶•í•˜í•´ì£¼ê¸° (Space)</button>`;
        modal.style.display = 'block';
    }

    function manualTrainAction() {
        const name = document.getElementById('sel-member').value;
        const stat = document.getElementById('sel-stat').value;
        const m = gameState.members.find(i => i.name === name);
        if (stat !== 'rest' && m.fatigue >= 100) return alert("í”¼ë¡œë„ ì´ˆê³¼!");
        m.manualAct = stat; alert(`${name} ì§€ì‹œ ì™„ë£Œ`); updateDisplay();
    }

    function closeModal() { document.getElementById('eventModal').style.display = 'none'; processNextPopup(); }
    function openPage(pId, btn) {
        document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
        document.getElementById(pId).classList.add('active');
        if(btn) btn.classList.add('active');
        updateDisplay();
    }
    updateDisplay();
</script>
</body>
</html>
